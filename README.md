# TankVoice — голосовой помощник для танковой игры

Голосовое управление танком в реальном времени: движение, прицеливание, выстрел и поворот башни по командам. Работает офлайн: микрофон, экран и игра — всё на твоём компьютере.

---

## Как пользоваться

### Запуск без установки

Запусти **`TankVoice.exe`** из папки `dist\`.  
Модели (распознавание речи и детекция целей) упакованы в exe. Ничего дополнительно ставить не нужно.

1. Запусти игру в оконном или полноэкранном режиме.
2. Запусти **TankVoice.exe**.
3. В левом верхнем углу появится оверлей:
   - **Поле состояния** — «В поиске цели», «Зафиксирован на цели» или «Пилот отключён».
   - **Кнопка Вкл/Выкл** — включить или выключить автоматическое прицеливание и детекцию.
   - **Крестик ×** — полное завершение программы (оверлей больше не показывается).

4. Говори команды в микрофон — они выполняются сразу после распознавания.

Микрофон должен быть включён и выбран в системе как устройство по умолчанию.

---

## Голосовые команды

### Пилот (автонаводка)

| Команда              | Действие |
|----------------------|----------|
| **включить пилота**  | Включить авто‑поиск целей и прицеливание. |
| **отключить пилота** | Выключить пилота; управление только голосом, без авто‑наводки. |

Когда пилот включён: программа ищет вражеские танки на экране, при обнаружении цели можно «зафиксироваться» (нажать ПКМ в игре или дать команду прицеливания), после чего прицел сам следует за целью.

---

### Движение

| Команда   | Действие |
|-----------|----------|
| **перед** | Зажать W примерно на 1 секунду. |
| **назад** | Зажать S примерно на 1 секунду. |
| **влево** | Зажать A примерно на 1 секунду. |
| **вправо** | Зажать D примерно на 1 секунду. |
| **стоп**, **стоп перед**, **стоп назад**, **стоп влево**, **стоп вправо** | Отпустить все клавиши движения. |

---

### Огонь и прицеливание

| Команда    | Действие |
|------------|----------|
| **выстрел** | Один клик левой кнопкой мыши (выстрел). |
| **отставить** | Отпустить прицеливание (как отпустить ПКМ). |

---

### Поворот башни по «часам»

Команды поворачивают башню как по циферблату: 12 часов — вперёд, 3 — вправо, 6 — назад, 9 — влево.

| Команда | Направление (примерно) |
|---------|-------------------------|
| **двенадцать часов** | 0° (вперёд) |
| **один час** … **одиннадцать часов** | 30° … 330° |
| **три часа** | 90° вправо |
| **шесть часов** | 180° (назад) |
| **девять часов** | 270° (влево) |

---

### Снаряды и снаряжение

| Команда            | Действие     |
|--------------------|-------------|
| **снаряд один**    | Клавиша 1.  |
| **снаряд два**     | Клавиша 2.  |
| **снаряд три**     | Клавиша 3.  |
| **снаряжение один**| Клавиша 4.  |
| **снаряжение два** | Клавиша 5.  |
| **снаряжение три** | Клавиша 6.  |

---

### Прицел (снайперский режим)

| Команда                    | Действие        |
|----------------------------|-----------------|
| **активировать снайперский**   | Скролл колёсиком мыши вверх.   |
| **деактивировать снайперский** | Скролл колёсиком мыши вниз.    |

---

## Как это устроено

1. **Голос**  
   Звук с микрофона обрабатывается офлайн‑моделью **Vosk** (русская модель в папке `model/`). Распознанный текст сверяется со списком фраз; совпавшая фраза выполняется как команда (движение, выстрел, поворот башни и т.д.). Часть команд может выполняться уже по частичному результату распознавания, чтобы реакция была быстрее.

2. **Поиск целей**  
   В отдельном потоке идёт захват экрана (**dxcam**) и прогон кадров через нейросеть **YOLO** (модель в `kronos_models/best.pt`). Модель обучена искать вражеские танки; когда объект с достаточной уверенностью найден, его координаты передаются в логику наводки.

3. **Режимы работы**  
   - **В поиске цели** — башня медленно поворачивается влево‑вправо, чтобы «подставить» цель под прицел.  
   - **Зафиксирован на цели** — после нажатия ПКМ (или аналогичного действия в игре) прицел удерживается на центре цели: программа двигает мышь так, чтобы цель оставалась в центре экрана. При высокой уверенности детекции периодически выполняются два клика ПКМ для удержания прицеливания в игре.

4. **Пилот вкл/выкл**  
   При выключенном пилоте детекция и авто‑наводка не работают; обрабатывается только команда «включить пилота». Это нужно, чтобы временно отключить автоприцел без выхода из программы.

5. **Оверлей**  
   Небольшое окно поверх игры показывает текущий статус (поиск / зафиксирован / пилот выключен), кнопку включения/выключения пилота и кнопку закрытия. По крестику программа завершается полностью (`os._exit(0)`), оверлей больше не показывается.

Итого: **микрофон → Vosk → команды → клавиатура/мышь и логика наводки**, **экран → dxcam → YOLO → координаты цели → движение мыши и ПКМ**. Всё выполняется на твоём ПК, без облака и без обязательного интернета после первого запуска.

---

## Сборка и разработка

- **Запуск из исходников:** в корне проекта нужны папки **`model`** (Vosk) и **`kronos_models`** (best.pt, yolov12n.pt). Установи зависимости: `pip install -r requirements.txt` (+ при необходимости `mouse`, `pywin32`, `dxcam`, `opencv-python`, `ultralytics` для полной функциональности).
- **Сборка exe:** выполни `build.bat` или `python -m PyInstaller --clean -y build.spec`. Результат: `dist\TankVoice.exe`.
